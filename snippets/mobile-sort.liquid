<link rel="preload" as="image" href="{{ "mobile-sort-background.png" | asset_url }}">
<div id="mobile-sort">
  <div class="exit-container">
    <img src="{{ "exit-light.png" | asset_url }}" height="20px" width="20px"/>
  </div>
  <div id="mobile-sort-menu">
    <div id="mobile-sort-cart-container">
      <a href="{{ routes.cart_url }}">
        <div class="mobile-sort-title">CART</div>
        <div class="cart-count">
          {{ cart.item_count }}
        </div>
      </a>
    </div>
    <div id="mobile-sort-container">
      <div class="mobile-sort-title">SORT</div>
      <div data-sort="featured" class="sort-option">FEATURED</div>
      <div data-sort="best-selling" class="sort-option">BEST SELLING</div>
      <div data-sort="price-low" class="sort-option">PRICE: LOW TO HIGH</div>
      <div data-sort="price-high" class="sort-option">PRICE: HIGH TO LOW</div>
      <div data-sort="newest" class="sort-option">NEWEST</div>
    </div>
  </div>
</div>
<style>
  .exit-container {
    position: absolute;
    top: 0;
    right: 0;
    direction: rtl;
  }
  
  .exit-container img {
    margin: 20px 20px 0 0;
  }
  
  .exit-container img:hover {
    cursor: pointer;
  }
  
  #mobile-sort {
    display: none;
    color: var(--font-color-light);
    width: 100vw;
    height: 100vh;
    position: fixed;
    background-image: url('{{ "mobile-sort-background.png" | asset_url }}');
    background-repeat: no-repeat;
    background-position: center;
    background-size: cover;
    z-index: 2000;
    top: 0;
    bottom: 0;
    right: 0;
  }

  #mobile-sort #mobile-sort-menu {
    height: 100vh;
    font-family: var(--font-family-secondary);
    font-stretch: expanded;
    font-size: 20px;
    gap: 50px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding-bottom: 100px;
  }
  
  #mobile-sort #mobile-sort-menu div:hover {
    cursor: pointer;
  }

  .mobile-sort-title {
    font-size: 15px;
    font-weight: 700;
    font-stretch: expanded; 
  }

  .sort-option {
    font-size: 18px;
    font-stretch: expanded; 
  }

  #mobile-sort-cart-container {
    text-align: center;
  }
  
  #mobile-sort-cart-container a,
  #mobile-sort-cart-container a:visited {
    color: var(--font-color-light);
  }

  #mobile-sort-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }

  #mobile-sort.show {
    display: block;
    animation: slideInRight 0.5s ease-out forwards;
  }

  #mobile-sort.hide {
    animation: slideOutRight 0.5s ease-out;
  }

  @keyframes slideInRight {
    from {
      transform: translateX(100%);
      opacity: 0;
    }
    to {
      transform: translateX(0);
      opacity: 1;
    }
  }

  @keyframes slideOutRight {
    from {
      transform: translateX(0);
      opacity: 1;
    }
    to {
      transform: translateX(100%);
      opacity: 0;
    }
  }

  @media screen and (min-width: 650px){

  .menu-sort-title {
    font-size: 28px;
  }

  #mobile-sort-cart-container .cart-count {
    font-size: 38px;
  }

  #mobile-sort-container .sort-option {
    font-size: 24px;
  }

    #mobile-nav #mobile-menu {
      height: 100%;
      gap: 50px;
    }
  }
</style>
<script>
document.addEventListener('DOMContentLoaded', function() {
  function updateActiveSortOption() {
    const urlParams = new URLSearchParams(window.location.search);
    const currentSort = urlParams.get('sort_by');
    
    const sortMap = {
      'manual': 'featured',
      'best-selling': 'best-selling',
      'price-ascending': 'price-low',
      'price-descending': 'price-high',
      'created-descending': 'newest'
    };
    
    // Remove wavy-underline from all options first
    document.querySelectorAll('.sort-option').forEach(el => {
      el.classList.remove('wavy-underline');
    });
    
    const activeSortValue = sortMap[currentSort] || 'featured';
    
    const activeSortElement = document.querySelector(`[data-sort="${activeSortValue}"]`);
    
    if (activeSortElement) {
      activeSortElement.classList.add('wavy-underline');
    }
  }
  
  updateActiveSortOption();
});
</script>