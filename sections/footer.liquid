<footer id="footer" class="srn-footer {% if page.handle == 'nursery' %}srn-footer--nursery{% elsif page.handle == 'garden-design' %}srn-footer--garden-design{% endif %}" role="contentinfo">
  <div class="srn-footer__content">
    
    <!-- Left: Navigation Menu -->
    <div class="srn-footer__side">
      <nav class="srn-footer__nav" aria-label="Footer navigation">
        <a href="{{ collections['web-shop'].url }}" class="srn-footer__nav-link">THE SHOP</a>
        <a href="/pages/nursery" class="srn-footer__nav-link">THE NURSERY</a>
        <a href="/pages/garden-design" class="srn-footer__nav-link">GARDEN DESIGN</a>
        <a href="/pages/nursery#contact" class="srn-footer__nav-link">CONTACT US</a>
        <a href="https://www.instagram.com/springroadnursery/" class="srn-footer__nav-link" target="_blank" rel="noopener noreferrer">INSTAGRAM</a>
      </nav>
    </div>

    <!-- Center: Logo -->
    <div class="srn-footer__logo">
      {% if page.handle == 'nursery' %}
        <img src="{{ 'inchworm-black.png' | asset_url }}" alt="Spring Road Nursery" width="auto" height="150"/>
      {% elsif page.handle == 'garden-design' %}
        <img src="{{ 'inchworm-light-green.png' | asset_url }}" alt="Spring Road Nursery" width="auto" height="150"/>
      {% else %}
        <img src="{{ 'inchworm.png' | asset_url }}" alt="Spring Road Nursery" width="auto" height="150"/>
      {% endif %}
    </div>

    <!-- Right: Newsletter Signup (Desktop) -->
    <div class="srn-footer__side">
      <h2 class="srn-footer__title wavy-underline">Keep In Touch</h2>
      <p class="srn-footer__text">
        From rare plants to handcrafted goods,
        we cultivate the strange and the beautiful
        on our mountainside in Vermont.
        Be the first to hear about
        what's unfurling in the garden.
      </p>
      
      <div class="srn-footer__form srn-footer__form--desktop">
        {% form 'customer', class: 'newsletter-form' %}
          {%- if form.posted_successfully? -%}
            <h3 class="newsletter-form__message newsletter-form__message--success" tabindex="-1" autofocus>
              {{- 'newsletter.success' | t }}
            </h3>
          {%- else -%}
            <input type="hidden" name="contact[tags]" value="newsletter">
            <div class="newsletter-form__field-wrapper">
              <div class="field">
                <input
                  id="NewsletterForm--footer-desktop"
                  type="email"
                  name="contact[email]"
                  class="field__input"
                  value="{{ form.email }}"
                  aria-required="true"
                  autocorrect="off"
                  autocapitalize="off"
                  autocomplete="email"
                  {% if form.errors %}
                    autofocus
                    aria-invalid="true"
                    aria-describedby="Newsletter-error--footer"
                  {% elsif form.posted_successfully? %}
                    aria-describedby="Newsletter-success--footer"
                  {% endif %}
                  placeholder=""
                  required
                >
                <label class="newsletter-label field__label" for="NewsletterForm--footer-desktop">
                  Your Email Here
                </label>
                <button
                  type="submit"
                  class="newsletter-form__button field__button"
                  name="commit"
                  aria-label="{{ 'newsletter.button_label' | t }}"
                >
                  <span class="svg-wrapper">
                    {{- 'icon-arrow.svg' | inline_asset_content -}}
                  </span>
                </button>
              </div>
              {%- if form.errors -%}
                <small class="newsletter-form__message form__message" id="Newsletter-error--footer">
                  <span class="svg-wrapper">
                    {{- 'icon-error.svg' | inline_asset_content -}}
                  </span>
                  {{- form.errors.translated_fields.email | capitalize }}
                  {{ form.errors.messages.email -}}
                </small>
              {%- endif -%}
            </div>
          {%- endif -%}
        {% endform %}
      </div>

    <!-- Newsletter Signup (Mobile) -->
    <div class="srn-footer__form srn-footer__form--mobile">
      {% form 'customer', class: 'newsletter-form' %}
        {%- if form.posted_successfully? -%}
          <div class="newsletter-form__message newsletter-form__message--success" tabindex="-1" autofocus>
            {{- 'newsletter.success' | t }}
          </div>
        {%- else -%}
          <input type="hidden" name="contact[tags]" value="newsletter">
          <div class="newsletter-form__field-wrapper">
            <div class="field">
              <input
                id="NewsletterForm--footer-mobile"
                type="email"
                name="contact[email]"
                class="field__input"
                value="{{ form.email }}"
                aria-required="true"
                autocorrect="off"
                autocapitalize="off"
                autocomplete="email"
                {% if form.errors %}
                  autofocus
                  aria-invalid="true"
                  aria-describedby="Newsletter-error--footer-mobile"
                {% elsif form.posted_successfully? %}
                  aria-describedby="Newsletter-success--footer-mobile"
                {% endif %}
                placeholder=""
                required
              >
              <label class="newsletter-label field__label" for="NewsletterForm--footer-mobile">
                Your Email Here
              </label>
              <button
                type="submit"
                class="newsletter-form__button field__button"
                name="commit"
                aria-label="{{ 'newsletter.button_label' | t }}"
              >
                <span class="svg-wrapper">
                  {{- 'icon-arrow.svg' | inline_asset_content -}}
                </span>
              </button>
            </div>
            {%- if form.errors -%}
              <small class="newsletter-form__message form__message" id="Newsletter-error--footer-mobile">
                <span class="svg-wrapper">
                  {{- 'icon-error.svg' | inline_asset_content -}}
                </span>
                {{- form.errors.translated_fields.email | capitalize }}
                {{ form.errors.messages.email -}}
              </small>
            {%- endif -%}
          </div>
        {%- endif -%}
      {% endform %}
      </div>
    </div>

  </div>

  <!-- Footer Details -->
  <div class="srn-footer__details">
    <span>Spring Road Nursery</span>
    <span>78 Spring Rd</span>
    <span>Tunbridge, VT 05077</span>
    <span>(802) 276-6481</span>
  </div>
</footer>

<style>
/* ============================================
   FOOTER STYLES
   ============================================ */

/* Base Styles */
.srn-footer {
  margin: 50px 0;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  color: var(--font-color-dark);
  font-family: var(--font-family-secondary);
}

.srn-footer a,
.srn-footer a:visited {
  color: var(--font-color-dark);
  text-decoration: none;
}

.srn-footer h2,
.srn-footer h3 {
  text-align: center;
}

/* Success Message */
.srn-footer .newsletter-form__message--success {
  font-family: var(--font-family-secondary);
  text-align: center;
}

/* Content Container */
.srn-footer__content {
  min-width: 700px;
  max-width: 1100px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

/* Side Sections */
.srn-footer__side {
  width: 33%;
  text-align: center;
  padding: 0 10px;
}

.srn-footer__title {
  font-weight: 500;
  font-size: 24px;
  letter-spacing: 1px;
  font-family: var(--font-family-secondary);
  text-transform: uppercase;
  text-decoration-thickness: 1px;
  padding: 0 50px;
  margin: 0;
}

.srn-footer__text {
  padding: 0 20px;
  margin: 20px 0;
  font-size: 15px;
  line-height: 1;
  font-weight: 500;
}

/* Navigation */
.srn-footer__nav {
  font-size: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  letter-spacing: 2px;
  gap: 5px;
  text-transform: uppercase;
  font-stretch: expanded;
}

.srn-footer__nav-link {
  transition: opacity 0.2s ease;
}

.srn-footer__nav-link:hover,
.srn-footer__nav-link:focus {
  opacity: 0.5;
}

/* Footer Details */
.srn-footer__details {
  margin-top: 65px;
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: center;
  gap: 25px;
  text-transform: uppercase;
  font-size: 12px;
  font-stretch: expanded;
}

/* Newsletter Form */
.srn-footer__form--desktop {
  margin-top: 20px;
  padding: 10px;
}

.srn-footer__form--mobile {
  display: none;
}

.srn-footer .newsletter-label {
  font-size: 14px;
  font-stretch: expanded;
  text-transform: uppercase;
}

@media (min-width: 769px) {
  .srn-footer__side:last-child {
    margin-top: 15px;
  }
}

/* Desktop - Label shrinks on focus */
.srn-footer__form--desktop .field__input:focus ~ .newsletter-label,
.srn-footer__form--desktop .field__input:not(:placeholder-shown) ~ .newsletter-label,
.srn-footer__form--desktop .field__input:-webkit-autofill ~ .newsletter-label {
  font-size: 1rem;
}

/* ============================================
   THEME VARIANTS
   ============================================ */

/* Nursery Theme */
.srn-footer--nursery,
.srn-footer--nursery a,
.srn-footer--nursery a:visited,
.srn-footer--nursery span,
.srn-footer--nursery .srn-footer__title,
.srn-footer--nursery .srn-footer__text,
.srn-footer--nursery .field__label,
.srn-footer--nursery .field__input {
  color: var(--font-color-dark-secondary);
}

/* Garden Design Theme */
.srn-footer--garden-design,
.srn-footer--garden-design a,
.srn-footer--garden-design a:visited,
.srn-footer--garden-design span,
.srn-footer--garden-design .srn-footer__title,
.srn-footer--garden-design .srn-footer__text,
.srn-footer--garden-design .field__label,
.srn-footer--garden-design .field__input {
  color: var(--font-color-light-quaternary);
  
}

.srn-footer--garden-design .srn-footer__title {
    border-bottom: 1px wavy color: var(--font-color-light-quaternary);;
    width: 100%;
    display: block;
  }

/* ============================================
   TABLET BREAKPOINT (481px - 990px)
   ============================================ */
@media (min-width: 481px) and (max-width: 990px) {
  .srn-footer__logo {
    display: none;
  }

  .srn-footer__side {
    width: 50%;
    padding: 0 10px;
  }
}

/* ============================================
   MOBILE BREAKPOINT (≤768px)
   ============================================ */
@media (max-width: 768px) {

  .srn-footer__side:last-child {
    margin-top: 0px;
  }

  .srn-footer__title  .wavy-underline {
    text-decoration: none !important;
  }

  .srn-footer {
    margin: 30px 0;
  }

  .srn-footer__logo {
    display: none;
  }

  .srn-footer__content {
    min-width: 0;
    width: 100%;
    align-items: center;
    flex-direction: column-reverse;
  }

  .srn-footer__side {
    width: 100%;
    padding: 0;
    margin-bottom: 15px;
  }

  /* Navigation - Mobile Layout */
  .srn-footer__nav {
    width: 100%;
    font-size: 12px;
    padding: 0;
    gap: 0;
    letter-spacing: 2px;
    line-height: 1.5;
    display: flex;
    flex-wrap: wrap;
    flex-direction: row;
    justify-content: center;
    align-items: center;
    position: relative;
    padding-bottom: 20px; 
  }

  .srn-footer__nav::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background: repeating-linear-gradient(
      to right,
      currentColor 0px,
      currentColor 2px,
      transparent 2px,
      transparent 4px
    );
  }

  .srn-footer__nav a {
    display: inline-block;
    white-space: nowrap;
  }

  /* Add divider after each link by default */
  .srn-footer__nav a::after {
    content: " | ";
    margin: 0 8px;
  }

  /* Remove divider from last item in each row */
  .srn-footer__nav a.srn-footer__nav-link--no-divider::after {
    content: none;
  }

  /* Title and Text */
  .srn-footer__title,
  .srn-footer__text {
    width: 100%;
    padding: 0 20px;
  }

  /* Forms - Show Mobile, Hide Desktop */
  .srn-footer__form--desktop {
    display: none;
  }

  .srn-footer__form--mobile {
    display: block;
    width: 100%;
    max-width: none;
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  .srn-footer__form--mobile .field__input, .select__select, .customer .field input, .customer select {
    border-radius: 0;
  }

  .srn-footer__form--mobile .field {
    width: 100%;
    max-width: none;
    padding: 0;
    margin: 0;
  }

  .srn-footer__form--mobile .field__input {
    width: 100%;
    background-color: var(--font-color-dark);
    color: var(--color-background);
  }

  .srn-footer__form--mobile .field__label,
  .srn-footer__form--mobile .field__input::placeholder {
    color: var(--color-background);
  }

  .srn-footer__form--mobile .field__input::placeholder {
    opacity: 0.7;
  }

  .srn-footer__form--mobile .svg-wrapper,
  .srn-footer__form--mobile .svg-wrapper svg {
    color: var(--color-background);
    fill: var(--color-background);
  }

  /* Nursery Theme */
.srn-footer--nursery,
.srn-footer--nursery a,
.srn-footer--nursery a:visited,
.srn-footer--nursery span,
.srn-footer--nursery .srn-footer__title,
.srn-footer--nursery .srn-footer__text{
  background-color: var(--font-color-dark-secondary);
  color: var(--color-background);
}

  /* Theme-specific mobile form backgrounds */
  .srn-footer--nursery .srn-footer__form--mobile .field__input {
    background-color: var(--font-color-dark-secondary);
  }

  .srn-footer--garden-design .srn-footer__form--mobile .field__input {
    background-color: var(--font-color-light-quaternary);
  }

  /* Mobile - Label shrinks on focus */
  .srn-footer__form--mobile .field__input:focus ~ .field__label,
  .srn-footer__form--mobile .field__input:not(:placeholder-shown) ~ .field__label,
  .srn-footer__form--mobile .field__input:-webkit-autofill ~ .field__label {
    font-size: 12px;
  }

  /* Footer Details */
  .srn-footer__details {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    gap: 10px;
    margin-top: 10px;
    padding: 0 3px;
  }

  .srn-footer__title {
    width: 100vw;
    text-decoration: none;
    position: relative;
    padding-bottom: 5px; 
  }

  .srn-footer__title::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background-color: currentColor;
    -webkit-mask-image: url("data:image/svg+xml,%3Csvg width='7' height='4' viewBox='0 0 7 4' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 2 Q 1.96 0, 3.92 2 T 7 2' stroke='black' stroke-width='1.5' fill='none' stroke-linecap='round'/%3E%3C/svg%3E");
    mask-image: url("data:image/svg+xml,%3Csvg width='7' height='4' viewBox='0 0 7 4' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 2 Q 1.96 0, 3.92 2 T 7 2' stroke='black' stroke-width='1.5' fill='none' stroke-linecap='round'/%3E%3C/svg%3E");
    -webkit-mask-size: 8px 4px;
    mask-size: 7px 4px;
    -webkit-mask-repeat: repeat-x;
    mask-repeat: repeat-x;
    -webkit-mask-position: center;
    mask-position: center;
  }
}

/* ============================================
   TABLET-SPECIFIC LABEL SIZE (768px - 990px)
   ============================================ */
@media (min-width: 768px) and (max-width: 990px) {
  .srn-footer__form--mobile .field__input:focus ~ .field__label,
  .srn-footer__form--mobile .field__input:not(:placeholder-shown) ~ .field__label,
  .srn-footer__form--mobile .field__input:-webkit-autofill ~ .field__label {
    font-size: 16px;
  }
}

@media (max-width: 650px){
  .srn-footer__details {
    margin: 0;
  }
  .srn-footer__details span:first-child {
    text-align: center;
    flex-basis: 100%;
  }
}
</style>

<script>
(function() {
  function updateFooterNavDividers() {
    const nav = document.querySelector('.srn-footer__nav');
    if (!nav) return;
    
    const links = Array.from(nav.querySelectorAll('a'));
    if (links.length === 0) return;
    
    // Remove all existing divider classes
    links.forEach(link => link.classList.remove('srn-footer__nav-link--no-divider'));
    
    // Get the top position of each link to determine rows
    let currentRow = links[0].offsetTop;
    let rowEndIndices = [];
    
    links.forEach((link, index) => {
      if (link.offsetTop > currentRow) {
        rowEndIndices.push(index - 1);
        currentRow = link.offsetTop;
      }
    });
    
    rowEndIndices.push(links.length - 1);
    
    // Add no-divider class to links at the end of each row
    rowEndIndices.forEach(index => {
      links[index].classList.add('srn-footer__nav-link--no-divider');
    });
  }

  // Run on load
  document.addEventListener('DOMContentLoaded', updateFooterNavDividers);

  // Run on resize (debounced for performance)
  let resizeTimer;
  window.addEventListener('resize', function() {
    clearTimeout(resizeTimer);
    resizeTimer = setTimeout(updateFooterNavDividers, 100);
  });
})();
</script>